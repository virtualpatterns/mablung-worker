{"version":3,"sources":["../../source/sandbox/fork.js"],"names":["ChildProcess","createRequire","Process","process","Require","_createRequire","import","meta","url","on","console","log","childProcess","fork","resolve","_onMessage","message","dir","send","error","setTimeout","exit","_onExit"],"mappings":"yDAAA,OAAOA,YAAP,MAAyB,eAAzB;AACA,SAASC,aAAT,QAA8B,QAA9B;;AAEA,MAAMC,OAAO,GAAGC,OAAhB;AACA,MAAMC,OAAO,GAJbC,cAAc,CAACC,MAAM,CAACC,IAAP,CAAYC,GAAb,CAId;;AAEAN,OAAO,CAACO,EAAR,CAAW,MAAX,EAAmB,MAAM;AACvBC,EAAAA,OAAO,CAACC,GAAR,CAAY,4CAAZ;AACD,CAFD;;AAIA,IAAIC,YAAY,GAAGZ,YAAY,CAACa,IAAb,CAAkBT,OAAO,CAACU,OAAR,CAAgB,aAAhB,CAAlB,EAAkD;AACnE;AACA,mBAAiB,UAFkD;AAGnE,WAAS,SAH0D,EAAlD,CAAnB;;;AAMA;AACA;AACA;AACA;AACA;;AAEAF,YAAY,CAACH,EAAb,CAAgB,SAAhB,EAA2BG,YAAY,CAACG,UAAb,GAA2BC,OAAD,IAAa;AAChEN,EAAAA,OAAO,CAACC,GAAR,CAAY,qFAAZ;AACAD,EAAAA,OAAO,CAACO,GAAR,CAAYD,OAAZ;AACAJ,EAAAA,YAAY,CAACM,IAAb,CAAkB,EAAE,QAAQ,KAAV,EAAlB,EAAsCC,KAAD,IAAW;AAC9C,QAAIA,KAAJ,EAAW;AACTT,MAAAA,OAAO,CAACS,KAAR,CAAcA,KAAd;AACD,KAFD,MAEO;AACLC,MAAAA,UAAU,CAAClB,OAAO,CAACmB,IAAT,EAAe,IAAf,CAAV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD;AACF,GAbD;AAcD,CAjBD;;AAmBAT,YAAY,CAACH,EAAb,CAAgB,MAAhB,EAAwBG,YAAY,CAACU,OAAb,GAAuB,MAAM;AACnDZ,EAAAA,OAAO,CAACC,GAAR,CAAY,wEAAZ;AACD,CAFD","sourcesContent":["import ChildProcess from 'child_process'\nimport { createRequire } from 'module'\n\nconst Process = process\nconst Require = __require\n\nProcess.on('exit', () => {\n  console.log('PARENT Process.on(\\'exit\\', () => { ... })')\n})\n\nlet childProcess = ChildProcess.fork(Require.resolve('./forked.js'), {\n  // 'execArgv': [ '--inspect' ],\n  'serialization': 'advanced',\n  'stdio': 'inherit'\n})\n\n// setTimeout(() => {\n//   console.log('PARENT ChildProcess.send({ \\'type\\': \\'ping\\' })')\n//   childProcess.send({ 'type': 'ping' })\n//   childProcess.off('message', childProcess._onMessage)\n// }, 5000)\n\nchildProcess.on('message', childProcess._onMessage = (message) => {\n  console.log('PARENT ChildProcess.on(\\'message\\', childProcess._onMessage = (message) => { ... })')\n  console.dir(message)\n  childProcess.send({ 'type': 'end' }, (error) => {\n    if (error) {\n      console.error(error)\n    } else {\n      setTimeout(Process.exit, 5000)\n      // childProcess.send({ 'type': 'end' }, (error) => {\n      //   if (error) {\n      //     console.error(error)\n      //   } else {\n      //     Process.exit()\n      //   }\n      // })\n    }\n  })\n})\n\nchildProcess.on('exit', childProcess._onExit = () => {\n  console.log('PARENT ChildProcess.on(\\'exit\\', childProcess._onExit = () => { ... })')\n})\n"],"file":"fork.js"}